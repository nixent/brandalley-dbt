version: 2

models:
  - name: ga_daily_stats
    description: "GA visit and transaction counts"
    columns:
      - name: date
      - name: traffic_channel
      - name: traffic_medium
      - name: traffic_campaign
      - name: traffic_source
      - name: device_browser
      - name: device_os
      - name: transactions
        meta:
          metrics:
            total_transactions_metric:
              label: 'Count of transactions'
              type: sum
              description: "Count of transactions"
            ga_conversion_rate:
              label: 'Conversion Rate - GA'
              type: number 
              description: 'Total transactions / Total visits'
              sql: "100*safe_divide(${total_transactions_metric},sum(${unique_visits}))"
              round: 2
      - name: revenue
        meta:
          metrics:
            total_revenue_metric:
              label: 'Total Revenue (Â£)'
              type: sum
              description: "Total Revenue"
      - name: unique_visits
        meta:
          metrics:
            total_visits_metric:
              label: 'Total unique visits'
              type: sum
              description: "Total unique visits"